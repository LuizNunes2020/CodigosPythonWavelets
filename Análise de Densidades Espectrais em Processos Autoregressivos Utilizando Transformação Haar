
Neste exemplo, foquei em explorar as densidades espectrais de diferentes n√≠veis na transforma√ß√£o Haar de um processo autoregressivo AR(1) com um coeficiente ùúô = ‚àí 0.6.
Comecei criando um processo AR(1), onde cada valor √© dependente do valor anterior, ajustado por um coeficiente  ùúô e adicionado a um ru√≠do branco. Essa depend√™ncia cria um padr√£o que √© fundamental para entender como as transforma√ß√µes subsequentes alteram a representa√ß√£o do sinal.
Ap√≥s gerar o processo AR(1), apliquei a transforma√ß√£o Haar, que √© uma t√©cnica de an√°lise de wavelet usada para decompor sinais em componentes de frequ√™ncia e escala. Esta transforma√ß√£o me permitiu observar as varia√ß√µes do sinal em diferentes n√≠veis de detalhe, desde o mais fino at√© o mais grosso.
Utilizei a fun√ß√£o de densidade espectral de pot√™ncia para calcular e visualizar como as frequ√™ncias do sinal s√£o distribu√≠das nos v√°rios n√≠veis da transforma√ß√£o Haar. Isto foi feito para cada n√≠vel, permitindo uma compara√ß√£o direta entre o sinal original e suas decomposi√ß√µes.


import numpy as np
import matplotlib.pyplot as plt

# Par√¢metros
phi = -0.6
n = 1024  # N√∫mero de pontos de dados
levels = 4  # N√∫mero de n√≠veis da decomposi√ß√£o Haar

# Gerar o processo AR(1)
np.random.seed(0)
X_ar = np.zeros(n)
epsilon = np.random.normal(0, 1, n)  # Ru√≠do branco
for t in range(1, n):
    X_ar[t] = phi * X_ar[t-1] + epsilon[t]

# Transforma√ß√£o Haar
haar_transform = [X_ar.copy()]  # Incluir o n√≠vel original
for level in range(1, levels + 1):
    # Aplicar m√©dia m√≥vel para simular a aproxima√ß√£o na decomposi√ß√£o Haar
    X_ar = (X_ar[:-1:2] + X_ar[1::2]) / 2
    haar_transform.append(X_ar.copy())

# Plotagem das densidades espectrais
plt.figure(figsize=(12, 10))

# Painel (a) - Densidade espectral do processo original e n√≠vel mais fino
plt.subplot(2, 1, 1)
plt.psd(haar_transform[0], NFFT=512, Fs=1, label='Processo Original (AR1)')
plt.psd(haar_transform[-1], NFFT=512, Fs=1, label='N√≠vel Mais Fino (Detalhe)')
plt.title('Densidade Espectral - Processo Original vs. N√≠vel Mais Fino')
plt.legend()

# Painel (b) - Densidades espectrais superpostas para os primeiros quatro n√≠veis
plt.subplot(2, 1, 2)
for i in range(1, levels + 1):
    plt.psd(haar_transform[i], NFFT=512, Fs=1, label=f'N√≠vel {i}')
plt.title('Densidades Espectrais - N√≠veis 1 a 4')
plt.legend()

plt.tight_layout()
plt.show()
